import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

type Locale = "pt-BR" | "en-US";

type Dictionary = Record<string, string>;

type Translations = Record<Locale, Dictionary>;

  const translations: Translations = {
    "pt-BR": {
    brand: "PetConnect",
    nav_sign_in: "Entrar",
    nav_get_started: "Começar Agora",
    hero_badge: "Cuidadores verificados e confiáveis",
    hero_title_line1: "Seu pet merece o",
    hero_title_line2: "melhor cuidado",
    hero_description:
      "Conecte-se com cuidadores experientes e apaixonados por animais. Hospedagem, passeios, visitas e muito mais para o seu melhor amigo.",
    hero_cta_find: "Encontrar um Cuidador",
    hero_cta_be: "Quero ser Cuidador",
    hero_stat_caregivers: "Cuidadores",
    hero_stat_pets: "Pets Felizes",
    hero_stat_rating: "Avaliação",
    cta_title: "Pronto para começar?",
    cta_description:
      "Junte-se a milhares de tutores e cuidadores que já confiam no PetConnect",
    cta_create_account: "Criar Conta Grátis",
    cta_learn_more: "Saiba Mais",
    lang_label: "Idioma",
    // Auth page
    auth_title: "Bem-vindo ao PetConnect",
    auth_description: "Crie sua conta ou faça login para continuar",
    tabs_login: "Entrar",
    tabs_signup: "Criar Conta",
    login_email_label: "Email",
    login_password_label: "Senha",
    login_submit: "Entrar",
    login_loading: "Entrando...",
    signup_name_label: "Nome Completo",
    signup_phone_label: "Telefone",
    signup_email_label: "Email",
    signup_password_label: "Senha",
    signup_submit: "Criar Conta",
    signup_loading: "Criando conta...",
    role_label: "Eu sou:",
    role_tutor_title: "Tutor",
    role_tutor_sub: "Tenho pets",
    role_caregiver_title: "Cuidador",
    role_caregiver_sub: "Cuido de pets",
    // Auth toasts and messages
    signup_success_title: "Conta criada!",
    signup_success_desc: "Verifique seu email para confirmar o cadastro.",
    signup_error_title: "Erro ao criar conta",
    login_success_title: "Bem-vindo!",
    login_success_desc: "Login realizado com sucesso.",
    login_error_title: "Erro ao fazer login",
    login_unconfirmed_title: "Email não confirmado",
    login_unconfirmed_desc: "Verifique seu email e confirme sua conta para acessar.",
    // Resend from login
    login_resend_hint: "Não recebeu o e-mail de confirmação?",
    login_resend_button: "Reenviar",
    login_resend_loading: "Reenviando...",
    login_resend_error_title: "Não foi possível reenviar",
    login_resend_success_title: "E-mail reenviado",
    login_resend_success_desc: "Verifique sua caixa de entrada (e spam).",
    verify_title: "Verifique seu e-mail",
    verify_description: "Enviamos um link de confirmação para o seu e-mail. Clique no link para ativar sua conta.",
    verify_email_label: "Seu e-mail",
    verify_resend_button: "Reenviar confirmação",
    verify_resend_loading: "Reenviando...",
    verify_resend_success_title: "E-mail reenviado",
    verify_resend_success_desc: "Verifique sua caixa de entrada (e spam).",
    verify_resend_error_title: "Não foi possível reenviar",
    verify_error_title: "E-mail obrigatório",
    verify_error_no_email: "Informe seu e-mail para reenviar a confirmação.",
    verify_hint: "Se não encontrar, verifique também sua pasta de spam ou promoções.",
    verify_already_confirmed: "Já confirmei, quero entrar",
    verify_back_to_auth: "Voltar para Login",
    // Dashboard
    dashboard_hello: "Olá",
    dashboard_caregiver_profile: "Perfil Cuidador",
    dashboard_search_caregivers: "Buscar Cuidadores",
    dashboard_logout: "Sair",
    dashboard_tabs_pets: "Meus Pets",
    dashboard_tabs_bookings: "Agendamentos",
    dashboard_add_pet: "Adicionar Pet",
    dashboard_no_pets: "Nenhum pet cadastrado",
    dashboard_no_pets_desc: "Comece adicionando informações sobre seu pet para encontrar cuidadores",
    dashboard_add_first_pet: "Adicionar Primeiro Pet",
    dashboard_years: "anos",
    dashboard_size_label: "Porte",
    dashboard_edit: "Editar",
    dashboard_bookings_title: "Agendamentos",
    dashboard_bookings_desc: "Gerencie suas solicitações de serviço",
    dashboard_no_bookings: "Nenhum agendamento",
    dashboard_no_bookings_desc: "Você ainda não tem agendamentos",
    dashboard_until: "até",
    service_hospedagem: "Hospedagem",
    service_passeio: "Passeio",
    service_visita_diaria: "Visita Diária",
    service_creche: "Creche",
    status_pendente: "Pendente",
    status_confirmado: "Confirmado",
    status_concluido: "Concluído",
    status_cancelado: "Cancelado",
    // Pet Form
    common_back: "Voltar",
    petform_title_edit: "Editar Pet",
    petform_title_new: "Adicionar Novo Pet",
    petform_name_label: "Nome do Pet *",
    petform_species_label: "Espécie *",
    petform_select_placeholder: "Selecione",
    species_dog: "Cachorro",
    species_cat: "Gato",
    species_other: "Outro",
    petform_breed_label: "Raça",
    petform_age_label: "Idade (anos)",
    petform_size_label: "Porte",
    size_small: "Pequeno",
    size_medium: "Médio",
    size_large: "Grande",
    size_giant: "Gigante",
    petform_weight_label: "Peso (kg)",
    petform_personality_label: "Temperamento",
    petform_personality_placeholder: "Ex: Calmo, brincalhão, medroso...",
    petform_allergies_label: "Alergias",
    petform_health_label: "Observações de Saúde",
    petform_health_placeholder: "Medicações, condições especiais...",
    petform_vaccinated: "Vacinado",
    petform_neutered: "Castrado",
    petform_submit_saving: "Salvando...",
    petform_submit_update: "Atualizar Pet",
    petform_submit_create: "Cadastrar Pet",
    petform_toast_update_success: "Pet atualizado com sucesso!",
    petform_toast_create_success: "Pet cadastrado com sucesso!",
    petform_toast_load_error: "Erro ao carregar dados do pet",
    petform_toast_save_error: "Erro ao salvar pet",
    common_not_authenticated: "Usuário não autenticado",
    // Booking Request
    booking_error_title: "Erro",
    booking_need_pet: "Você precisa cadastrar um pet antes de solicitar serviços",
    booking_caregiver_not_found: "Cuidador não encontrado",
    booking_request_title: "Solicitar Serviço",
    booking_request_desc_prefix: "Preencha os detalhes da solicitação para",
    booking_select_pet_label: "Selecione o Pet *",
    booking_select_pet_placeholder: "Escolha um pet",
    booking_select_service_label: "Tipo de Serviço *",
    booking_select_service_placeholder: "Escolha o serviço",
    booking_date_start_label: "Data Início *",
    booking_date_end_label: "Data Fim *",
    booking_instructions_label: "Instruções Especiais",
    booking_instructions_placeholder: "Informações importantes sobre seu pet, medicações, horários, etc.",
    booking_total_label: "Valor Total",
    booking_submit_loading: "Enviando...",
    booking_submit: "Enviar Solicitação",
    booking_toast_load_error: "Erro ao carregar dados",
    booking_toast_required_fields: "Preencha todos os campos obrigatórios",
    booking_toast_success: "Solicitação enviada com sucesso!",
    booking_toast_error: "Erro ao enviar solicitação",
  },
  "en-US": {
    brand: "PetConnect",
    nav_sign_in: "Sign in",
    nav_get_started: "Get Started",
    hero_badge: "Verified and trusted caregivers",
    hero_title_line1: "Your pet deserves the",
    hero_title_line2: "best care",
    hero_description:
      "Connect with experienced caregivers who love animals. Boarding, walks, visits and much more for your best friend.",
    hero_cta_find: "Find a Caregiver",
    hero_cta_be: "I want to be a Caregiver",
    hero_stat_caregivers: "Caregivers",
    hero_stat_pets: "Happy Pets",
    hero_stat_rating: "Rating",
    cta_title: "Ready to start?",
    cta_description:
      "Join thousands of pet parents and caregivers who already trust PetConnect",
    cta_create_account: "Create Free Account",
    cta_learn_more: "Learn More",
    lang_label: "Language",
    // Auth page
    auth_title: "Welcome to PetConnect",
    auth_description: "Create your account or sign in to continue",
    tabs_login: "Sign In",
    tabs_signup: "Create Account",
    login_email_label: "Email",
    login_password_label: "Password",
    login_submit: "Sign In",
    login_loading: "Signing in...",
    signup_name_label: "Full Name",
    signup_phone_label: "Phone",
    signup_email_label: "Email",
    signup_password_label: "Password",
    signup_submit: "Create Account",
    signup_loading: "Creating account...",
    role_label: "I am:",
    role_tutor_title: "Pet Parent",
    role_tutor_sub: "I have pets",
    role_caregiver_title: "Caregiver",
    role_caregiver_sub: "I care for pets",
    // Auth toasts and messages
    signup_success_title: "Account created!",
    signup_success_desc: "Check your email to confirm your registration.",
    signup_error_title: "Error creating account",
    login_success_title: "Welcome!",
    login_success_desc: "Login successful.",
    login_error_title: "Error signing in",
    login_unconfirmed_title: "Email not confirmed",
    login_unconfirmed_desc: "Check your email and confirm your account to access.",
    // Resend from login
    login_resend_hint: "Didn't receive the confirmation email?",
    login_resend_button: "Resend",
    login_resend_loading: "Resending...",
    login_resend_error_title: "Could not resend",
    login_resend_success_title: "Email resent",
    login_resend_success_desc: "Please check your inbox (and spam).",
    verify_title: "Check your email",
    verify_description: "We sent a confirmation link to your email. Click the link to activate your account.",
    verify_email_label: "Your email",
    verify_resend_button: "Resend confirmation",
    verify_resend_loading: "Resending...",
    verify_resend_success_title: "Email resent",
    verify_resend_success_desc: "Please check your inbox (and spam).",
    verify_resend_error_title: "Could not resend",
    verify_error_title: "Email required",
    verify_error_no_email: "Provide your email to resend the confirmation.",
    verify_hint: "If you can't find it, check your spam or promotions folder.",
    verify_already_confirmed: "I've confirmed, let me sign in",
    verify_back_to_auth: "Back to Login",
    // Dashboard
    dashboard_hello: "Hello",
    dashboard_caregiver_profile: "Caregiver Profile",
    dashboard_search_caregivers: "Search Caregivers",
    dashboard_logout: "Sign out",
    dashboard_tabs_pets: "My Pets",
    dashboard_tabs_bookings: "Bookings",
    dashboard_add_pet: "Add Pet",
    dashboard_no_pets: "No pets yet",
    dashboard_no_pets_desc: "Start by adding information about your pet to find caregivers",
    dashboard_add_first_pet: "Add First Pet",
    dashboard_years: "years",
    dashboard_size_label: "Size",
    dashboard_edit: "Edit",
    dashboard_bookings_title: "Bookings",
    dashboard_bookings_desc: "Manage your service requests",
    dashboard_no_bookings: "No bookings",
    dashboard_no_bookings_desc: "You don't have any bookings yet",
    dashboard_until: "until",
    service_hospedagem: "Boarding",
    service_passeio: "Walk",
    service_visita_diaria: "Daily Visit",
    service_creche: "Daycare",
    status_pendente: "Pending",
    status_confirmado: "Confirmed",
    status_concluido: "Completed",
    status_cancelado: "Cancelled",
    // Pet Form
    common_back: "Back",
    petform_title_edit: "Edit Pet",
    petform_title_new: "Add New Pet",
    petform_name_label: "Pet Name *",
    petform_species_label: "Species *",
    petform_select_placeholder: "Select",
    species_dog: "Dog",
    species_cat: "Cat",
    species_other: "Other",
    petform_breed_label: "Breed",
    petform_age_label: "Age (years)",
    petform_size_label: "Size",
    size_small: "Small",
    size_medium: "Medium",
    size_large: "Large",
    size_giant: "Giant",
    petform_weight_label: "Weight (kg)",
    petform_personality_label: "Temperament",
    petform_personality_placeholder: "e.g., Calm, playful, shy...",
    petform_allergies_label: "Allergies",
    petform_health_label: "Health Notes",
    petform_health_placeholder: "Medications, special conditions...",
    petform_vaccinated: "Vaccinated",
    petform_neutered: "Neutered",
    petform_submit_saving: "Saving...",
    petform_submit_update: "Update Pet",
    petform_submit_create: "Create Pet",
    petform_toast_update_success: "Pet updated successfully!",
    petform_toast_create_success: "Pet created successfully!",
    petform_toast_load_error: "Error loading pet data",
    petform_toast_save_error: "Error saving pet",
    common_not_authenticated: "User not authenticated",
    // Booking Request
    booking_error_title: "Error",
    booking_need_pet: "You need to add a pet before requesting services",
    booking_caregiver_not_found: "Caregiver not found",
    booking_request_title: "Request Service",
    booking_request_desc_prefix: "Fill in the request details for",
    booking_select_pet_label: "Select Pet *",
    booking_select_pet_placeholder: "Choose a pet",
    booking_select_service_label: "Service Type *",
    booking_select_service_placeholder: "Choose a service",
    booking_date_start_label: "Start Date *",
    booking_date_end_label: "End Date *",
    booking_instructions_label: "Special Instructions",
    booking_instructions_placeholder: "Important info about your pet, medications, schedules, etc.",
    booking_total_label: "Total Price",
    booking_submit_loading: "Sending...",
    booking_submit: "Submit Request",
    booking_toast_load_error: "Error loading data",
    booking_toast_required_fields: "Please fill in all required fields",
    booking_toast_success: "Request sent successfully!",
    booking_toast_error: "Error sending request",
  },
};

type I18nContextType = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (key: string) => string;
};

const I18nContext = createContext<I18nContextType | null>(null);

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [locale, setLocaleState] = useState<Locale>(() => {
    const saved = localStorage.getItem("app_locale") as Locale | null;
    return saved || "pt-BR";
  });

  useEffect(() => {
    localStorage.setItem("app_locale", locale);
  }, [locale]);

  const setLocale = (next: Locale) => setLocaleState(next);

  const t = useMemo(() => {
    const dict = translations[locale];
    return (key: string) => dict[key] ?? key;
  }, [locale]);

  const value = useMemo(() => ({ locale, setLocale, t }), [locale]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useTranslation() {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error("useTranslation must be used within I18nProvider");
  return ctx;
}